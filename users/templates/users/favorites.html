{% extends 'base/base.html' %}
{% block content %}

<div class="min-h-screen py-14 px-4">
  <div class="max-w-7xl mx-auto">

    <!-- Page Title -->
    <div class="mb-10">
      <h1 class="text-4xl font-semibold text-gray-900">
        –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
      </h1>
      <p class="text-gray-500 mt-2">
        –¢–æ–≤–∞—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –¥–æ–±–∞–≤–∏–ª–∏ ‚ù§Ô∏è
      </p>
    </div>

    {% if products %}

    <!-- Products Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">

      {% for product in products %}
      <div class="relative group">

        <!-- REMOVE FROM FAVORITES -->
        <form method="post"
              action="{% url 'toggle_favorite' product.id %}"
              class="absolute top-4 right-4 z-10">
          {% csrf_token %}
          <button type="submit"
                  class="w-10 h-10 rounded-full
                         flex items-center justify-center
                         bg-red-500 text-white
                         hover:bg-red-600 transition">
            ‚ô•
          </button>
        </form>

        <!-- CARD -->
        <a href="{% url 'product_detail' product.slug %}" class="block">

          <div class="bg-white rounded-3xl shadow-sm hover:shadow-md transition
                      h-[420px] p-6 flex flex-col items-center">

            <!-- Image -->
            <div class="w-[180px] h-[180px] flex items-center justify-center mb-4">
              <img src="{{ product.get_image }}"
                   alt="{{ product.name }}"
                   onerror="this.src='/static/img/no_image.png'"
                   class="w-full h-full object-contain
                          group-hover:scale-105 transition duration-300">
            </div>

            <!-- Name -->
            <div class="text-center flex-1 w-full">
              <h2 class="text-[15px] font-semibold text-gray-900 uppercase
                         leading-snug break-words line-clamp-3">
                {{ product.name }}
              </h2>
            </div>

            <!-- Price + Cart -->
            <div class="mt-4 w-full flex flex-col items-center gap-3">
              <span class="text-[20px] font-bold text-gray-900">
                {{ product.price|floatformat:0 }} ‚ÇΩ
              </span>

              <form method="post"
                    action="{% url 'add_to_cart' product.id %}"
                    class="w-full">
                {% csrf_token %}
                <input type="hidden" name="next" value="{{ request.path }}">
                <button type="submit"
                        class="w-full h-[44px] rounded-full
                               bg-[#00BEA2] text-white font-semibold
                               hover:bg-[#05B197] transition shadow-sm">
                  –í –∫–æ—Ä–∑–∏–Ω—É
                </button>
              </form>
            </div>

          </div>
        </a>
      </div>
      {% endfor %}

    </div>

    {% else %}

    <!-- EMPTY FAVORITES -->
    <div class="p-16 text-center">

      <div class="text-6xl mb-6">üíî</div>

      <h2 class="text-2xl font-semibold text-gray-900 mb-3">
        –í –∏–∑–±—Ä–∞–Ω–Ω–æ–º –ø–æ–∫–∞ –ø—É—Å—Ç–æ
      </h2>

      <p class="text-gray-500 mb-8 max-w-md mx-auto">
        –î–æ–±–∞–≤–ª—è–π—Ç–µ —Ç–æ–≤–∞—Ä—ã –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –∏—Ö.
      </p>

      <div class="flex justify-center">
        <a href="{% url 'categories' %}"
           class="inline-block h-[44px] px-[30px]
                  rounded-full
                  bg-[#00BEA2] text-white
                  text-[14px] font-semibold
                  hover:bg-[#05B197]
                  transition shadow-sm">
          –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥
        </a>
      </div>

    </div>

    {% endif %}

  </div>
</div>

{% endblock %}